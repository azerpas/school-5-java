name: CI

on: [push, pull_request, pull_request_target]

jobs:
    build-and-test:
      runs-on: ubuntu-latest
      if: >
        github.event_name == 'push' ||
        github.event_name == 'pull_request_target' && github.event.pull_request.head.repo.full_name != github.repository
      steps:
          - uses: actions/checkout@v2
          - name: Setup Ubuntu
            run: sudo apt-get install language-pack-en language-pack-de
          - name: Set up JDK 11
            uses: actions/setup-java@v1
            with:
              java-version: 11
          - name: Publish Unit Test Results
            uses: EnricoMi/publish-unit-test-result-action@v1.3
            if: always()
            with:
              github_token: ${{ secrets.GITHUB_TOKEN }}
              check_name: Unit Test Results
              comment_title: Unit Test Statistics
              hide_comments: all but latest
              files: test-results/**/*.xml
              report_individual_runs: true
              deduplicate_classes_by_file_name: false